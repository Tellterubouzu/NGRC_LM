[log] train loss: 7.681636810302734, step: 500, tokens_seen_global: 4096000, tokens_per_sec_global: 22104.75934378123, max_mem_mb: 3696.823296
[log] train loss: 7.285130500793457, step: 1000, tokens_seen_global: 8192000, tokens_per_sec_global: 22654.473745289477, max_mem_mb: 3696.823296
[log] train loss: 6.777656078338623, step: 1500, tokens_seen_global: 12288000, tokens_per_sec_global: 22868.809955369106, max_mem_mb: 3696.82432
[log] train loss: 7.537596702575684, step: 2000, tokens_seen_global: 16384000, tokens_per_sec_global: 22727.524933583634, max_mem_mb: 3696.82432
[log] train loss: 6.866714954376221, step: 2500, tokens_seen_global: 20480000, tokens_per_sec_global: 22680.68724237104, max_mem_mb: 3696.82432
[log] train loss: 7.232715129852295, step: 3000, tokens_seen_global: 24576000, tokens_per_sec_global: 22693.358516695225, max_mem_mb: 3696.82432
[log] train loss: 6.657191276550293, step: 3500, tokens_seen_global: 28672000, tokens_per_sec_global: 22760.81188132118, max_mem_mb: 3696.82432
[log] train loss: 7.065340518951416, step: 4000, tokens_seen_global: 32768000, tokens_per_sec_global: 22730.434460782548, max_mem_mb: 3696.82432
[log] train loss: 6.850584983825684, step: 4500, tokens_seen_global: 36864000, tokens_per_sec_global: 22688.922230608387, max_mem_mb: 3696.82432
[log] train loss: 6.7559919357299805, step: 5000, tokens_seen_global: 40960000, tokens_per_sec_global: 22699.567908571724, max_mem_mb: 3696.82432
[log] train loss: 6.776937007904053, step: 5500, tokens_seen_global: 45056000, tokens_per_sec_global: 22669.916683362357, max_mem_mb: 3696.82432
[log] train loss: 6.800461769104004, step: 6000, tokens_seen_global: 49152000, tokens_per_sec_global: 22597.348025500214, max_mem_mb: 3696.82432
[log] train loss: 6.668797016143799, step: 6500, tokens_seen_global: 53248000, tokens_per_sec_global: 22590.386446016437, max_mem_mb: 3696.82432
[log] train loss: 6.445990562438965, step: 7000, tokens_seen_global: 57344000, tokens_per_sec_global: 22587.959840930802, max_mem_mb: 3696.82432
[log] train loss: 6.670224189758301, step: 7500, tokens_seen_global: 61440000, tokens_per_sec_global: 22577.622060781876, max_mem_mb: 3696.82432
[log] train loss: 6.706450939178467, step: 8000, tokens_seen_global: 65536000, tokens_per_sec_global: 22589.94362911047, max_mem_mb: 3696.82432
[log] train loss: 6.654726982116699, step: 8500, tokens_seen_global: 69632000, tokens_per_sec_global: 22603.68359712427, max_mem_mb: 3696.82432
[log] train loss: 6.928631782531738, step: 9000, tokens_seen_global: 73728000, tokens_per_sec_global: 22589.553819220982, max_mem_mb: 3696.82432
[log] train loss: 6.496344566345215, step: 9500, tokens_seen_global: 77824000, tokens_per_sec_global: 22583.991523041637, max_mem_mb: 3696.82432
[log] train loss: 6.793198108673096, step: 10000, tokens_seen_global: 81920000, tokens_per_sec_global: 22590.107791844857, max_mem_mb: 3696.82432
[log] train loss: 6.6326823234558105, step: 10500, tokens_seen_global: 86016000, tokens_per_sec_global: 22573.878135938, max_mem_mb: 3696.82432
[log] train loss: 6.9972357749938965, step: 11000, tokens_seen_global: 90112000, tokens_per_sec_global: 22570.246557135048, max_mem_mb: 3696.82432
[log] train loss: 6.671722412109375, step: 11500, tokens_seen_global: 94208000, tokens_per_sec_global: 22581.01169870394, max_mem_mb: 3696.82432
[log] train loss: 7.0791144371032715, step: 12000, tokens_seen_global: 98304000, tokens_per_sec_global: 22588.68815165077, max_mem_mb: 3696.82432
HF upload skipped (token absent or repo not specified).
▶️ babylm テストセットで mean-so-far-PPL を最大 2048 トークンまで計測します…
Repo card metadata block was not found. Setting CardData to empty.
Computing mean-so-far PPL: 100%|██████████| 100/100 [00:04<00:00, 22.56it/s]
Inference time: 4.44s, Tokens/sec: 46144.57, Memory: 1441.96MB
Traceback (most recent call last):
  File "/work/gp36/b20072/NGRC_LM/src/ngrc_lm.py", line 1035, in <module>
    main()
  File "/work/gp36/b20072/NGRC_LM/src/ngrc_lm.py", line 1028, in main
    NGRC_experiment(lr=args.learning_rate)
  File "/work/gp36/b20072/NGRC_LM/src/ngrc_lm.py", line 997, in NGRC_experiment
    wandb.log({"mean_so_far_ppl_curve": chart})
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/wandb_run.py", line 399, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/wandb_run.py", line 457, in wrapper_fn
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/wandb_run.py", line 444, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/wandb_run.py", line 2028, in log
    self._log(data=data, step=step, commit=commit)
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/wandb_run.py", line 1739, in _log
    self._partial_history_callback(data, step, commit)
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/wandb_run.py", line 399, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/wandb_run.py", line 1566, in _partial_history_callback
    self._backend.interface.publish_partial_history(
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/interface/interface.py", line 682, in publish_partial_history
    data = history_dict_to_json(run, data, step=user_step, ignore_copy_err=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/data_types/utils.py", line 54, in history_dict_to_json
    payload[key] = val_to_json(
                   ^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/data_types/utils.py", line 151, in val_to_json
    _log_table_artifact(val, key, run)
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/data_types/utils.py", line 198, in _log_table_artifact
    art = InternalArtifact(f"run-{run.id}-{key}", "run_table")
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/artifacts/_internal_artifact.py", line 51, in __init__
    super().__init__(
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/artifacts/artifact.py", line 271, in __init__
    ArtifactManifestV1(storage_policy=make_storage_policy())
                                      ^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/artifacts/_factories.py", line 17, in make_storage_policy
    return WandbStoragePolicy.from_config({"storageLayout": layout})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/artifacts/storage_policies/wandb_storage_policy.py", line 101, in from_config
    return cls(config=config, api=api)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/artifacts/storage_policies/wandb_storage_policy.py", line 109, in __init__
    self._cache = cache or get_artifact_file_cache()
                           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/artifacts/artifact_file_cache.py", line 251, in get_artifact_file_cache
    return _build_artifact_file_cache(env.get_cache_dir() / "artifacts")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/artifacts/artifact_file_cache.py", line 247, in _build_artifact_file_cache
    return ArtifactFileCache(cache_dir)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/artifacts/artifact_file_cache.py", line 47, in __init__
    self._sys_umask = _get_sys_umask_threadsafe()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/gj26/b20072/miniconda3/envs/esn/lib/python3.11/site-packages/wandb/sdk/artifacts/artifact_file_cache.py", line 35, in _get_sys_umask_threadsafe
    return int(subprocess.check_output(umask_cmd))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: invalid literal for int() with base 10: b'User customization module loaded!\n23\n'
